<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-x-mtfrom-en"><head><meta http-equiv="X-Translated-By" content="Google"><link href="https://apachecn.github.io/geeksforgeeks-zh/docs/en/net/148.html" hreflang="en" rel="alternate machine-translated-from"><title></title><link href="../../../styles/ebook.css" type="text/css" rel="stylesheet"></head><body><header class="entry-header"><h1 class="entry-title"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> C&#x4E2D;&#x7684;UDP&#x670D;&#x52A1;&#x5668; - &#x5BA2;&#x6237;&#x7AEF;&#x5B9E;&#x73B0;</span> </h1></header><!-- .entry-header --><div class="entry-content"><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x6709;&#x4E24;&#x79CD;&#x4E3B;&#x8981;&#x7684;&#x4F20;&#x8F93;&#x5C42;&#x534F;&#x8BAE;&#xFF1A; <strong><a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol">TCP</a></strong>&#x548C;<strong><a href="https://en.wikipedia.org/wiki/User_Datagram_Protocol">UDP</a></strong> &#x3002;</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <a href="https://www.geeksforgeeks.org/socket-programming-cc/">&#x5728;&#x4E4B;&#x524D;&#x7684;&#x6587;&#x7AE0;&#x4E2D;</a>&#x8BA8;&#x8BBA;&#x4E86;&#x521B;&#x5EFA;TCP&#x670D;&#x52A1;&#x5668;/&#x5BA2;&#x6237;&#x7AEF;&#x3002;</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5148;&#x51B3;&#x6761;&#x4EF6;&#xFF1A; <a href="https://www.geeksforgeeks.org/socket-programming-cc/" rel="noopener" target="_blank">&#x521B;&#x5EFA;TCP&#x670D;&#x52A1;&#x5668;/&#x5BA2;&#x6237;&#x7AEF;</a></span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x7406;&#x8BBA;</strong></span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5728;UDP&#x4E2D;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x4E0D;&#x50CF;TCP&#x90A3;&#x6837;&#x4E0E;&#x670D;&#x52A1;&#x5668;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x800C;&#x53EA;&#x662F;&#x53D1;&#x9001;&#x6570;&#x636E;&#x62A5;&#x3002;</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x540C;&#x6837;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x4E0D;&#x9700;&#x8981;&#x63A5;&#x53D7;&#x8FDE;&#x63A5;&#xFF0C;&#x53EA;&#x9700;&#x7B49;&#x5F85;&#x6570;&#x636E;&#x62A5;&#x5230;&#x8FBE;&#x3002;</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5230;&#x8FBE;&#x65F6;&#x7684;&#x6570;&#x636E;&#x62A5;&#x5305;&#x542B;&#x670D;&#x52A1;&#x5668;&#x7528;&#x4E8E;&#x5C06;&#x6570;&#x636E;&#x53D1;&#x9001;&#x5230;&#x6B63;&#x786E;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x53D1;&#x9001;&#x65B9;&#x5730;&#x5740;&#x3002;</span> <br> <a href="https://cdncontribute.geeksforgeeks.org/wp-content/uploads/udpfuncdiag.png"><img src="../../../imgs/net/5011e949e58ad299ef4621050c5290f0.jpg" alt="UDP&#x5BA2;&#x6237;&#x7AEF;/&#x670D;&#x52A1;&#x5668;&#x529F;&#x80FD;&#x8C03;&#x7528;" class="size-medium wp-image-351895"></a> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x6B65;&#x9AA4;&#xFF1A;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>UDP&#x670D;&#x52A1;&#x5668;&#xFF1A;</strong></span> </p><ol><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x521B;&#x5EFA;UDP&#x5957;&#x63A5;&#x5B57;&#x3002;</span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5C06;&#x5957;&#x63A5;&#x5B57;&#x7ED1;&#x5B9A;&#x5230;&#x670D;&#x52A1;&#x5668;&#x5730;&#x5740;&#x3002;</span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x7B49;&#x5230;&#x6570;&#x636E;&#x62A5;&#x5305;&#x4ECE;&#x5BA2;&#x6237;&#x7AEF;&#x5230;&#x8FBE;&#x3002;</span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5904;&#x7406;&#x6570;&#x636E;&#x62A5;&#x5305;&#x5E76;&#x5411;&#x5BA2;&#x6237;&#x7AEF;&#x53D1;&#x9001;&#x56DE;&#x590D;&#x3002;</span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x56DE;&#x5230;&#x7B2C;3&#x6B65;&#x3002;</span> </li></ol><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>UDP&#x5BA2;&#x6237;&#x7AEF;&#xFF1A;</strong></span> </p><br><!-- post_top_responsive --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9465609616171866" data-ad-slot="4501693235" data-ad-format="auto"></ins><br><ol><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x521B;&#x5EFA;UDP&#x5957;&#x63A5;&#x5B57;&#x3002;</span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x53D1;&#x9001;&#x6D88;&#x606F;&#x7ED9;&#x670D;&#x52A1;&#x5668;&#x3002;</span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x7B49;&#x5230;&#x6536;&#x5230;&#x670D;&#x52A1;&#x5668;&#x7684;&#x54CD;&#x5E94;&#x3002;</span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5904;&#x7406;&#x56DE;&#x590D;&#x5E76;&#x5728;&#x5FC5;&#x8981;&#x65F6;&#x8FD4;&#x56DE;&#x6B65;&#x9AA4;2&#x3002;</span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5173;&#x95ED;&#x5957;&#x63A5;&#x5B57;&#x63CF;&#x8FF0;&#x7B26;&#x5E76;&#x9000;&#x51FA;&#x3002;</span> </li></ol><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x5FC5;&#x8981;&#x7684;&#x529F;&#x80FD;&#xFF1A;</strong></span> </p><pre> <span class="pre-span" style="direction: ltr; text-align: left">int socket(int domain, int type, int protocol)</span>
<span class="pre-span" style="direction: ltr; text-align: left">Creates an unbound socket in the specified domain.</span>
<span class="pre-span" style="direction: ltr; text-align: left">Returns socket file descriptor.</span>
</pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x53C2;&#x6570;&#xFF1A;</strong></span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>domain  -</strong>&#x6307;&#x5B9A;&#x901A;&#x4FE1;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x57DF;&#xFF08;IPv6&#x7684;AF_INET&#x7528;&#x4E8E;IPv6&#x7684;AF_INET6&#xFF09;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>type  -</strong>&#x8981;&#x521B;&#x5EFA;&#x7684;&#x5957;&#x63A5;&#x5B57;&#x7C7B;&#x578B;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> &#xFF08;&#x7528;&#x4E8E;UDP&#x7684;TCP / SOCK_DGRAM&#x7684;SOCK_STREAM&#xFF09;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>protocol  -</strong>&#x5957;&#x63A5;&#x5B57;&#x4F7F;&#x7528;&#x7684;&#x534F;&#x8BAE;&#x3002;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> 0&#x8868;&#x793A;&#x4F7F;&#x7528;&#x5730;&#x5740;&#x65CF;&#x7684;&#x9ED8;&#x8BA4;&#x534F;&#x8BAE;&#x3002;</span> </p><pre> <span class="pre-span" style="direction: ltr; text-align: left">int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen)</span>
<span class="pre-span" style="direction: ltr; text-align: left">Assigns address to the unbound socket.</span>
</pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x53C2;&#x6570;&#xFF1A;</strong></span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>sockfd  -</strong>&#x8981;&#x7ED1;&#x5B9A;&#x7684;&#x5957;&#x63A5;&#x5B57;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>addr  -</strong>&#x6307;&#x5B9A;&#x8981;&#x7ED1;&#x5B9A;&#x5230;&#x7684;&#x5730;&#x5740;&#x7684;&#x7ED3;&#x6784;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>addrlen  -</strong> <em>addr</em>&#x7ED3;&#x6784;&#x7684;&#x5927;&#x5C0F;</span> </p><pre> <span class="pre-span" style="direction: ltr; text-align: left">ssize_t sendto(int sockfd, const void *buf, size_t len, int flags,</span>
               <span class="pre-span" style="direction: ltr; text-align: left">const struct sockaddr *dest_addr, socklen_t addrlen)</span>
<span class="pre-span" style="direction: ltr; text-align: left">Send a message on the socket</span>
</pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x53C2;&#x6570;&#xFF1A;</strong></span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>sockfd  -</strong>&#x5957;&#x63A5;&#x5B57;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>buf  -</strong>&#x5305;&#x542B;&#x8981;&#x53D1;&#x9001;&#x7684;&#x6570;&#x636E;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7F13;&#x51B2;&#x533A;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>len  -</strong> <em>buf</em>&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x5927;&#x5C0F;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>flags  -</strong>&#x7528;&#x4E8E;&#x4FEE;&#x6539;&#x5957;&#x63A5;&#x5B57;&#x884C;&#x4E3A;&#x7684;&#x6807;&#x5FD7;&#x7684;&#x6309;&#x4F4D;OR</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>dest_addr  -</strong>&#x5305;&#x542B;&#x76EE;&#x6807;&#x5730;&#x5740;&#x7684;&#x7ED3;&#x6784;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>addrlen  -</strong> <em>dest_addr</em>&#x7ED3;&#x6784;&#x7684;&#x5927;&#x5C0F;</span> </p><pre> <span class="pre-span" style="direction: ltr; text-align: left">ssize_t recvfrom(int sockfd, void *buf, size_t len, int flags,</span>
                 <span class="pre-span" style="direction: ltr; text-align: left">struct sockaddr *src_addr, socklen_t *addrlen)</span>
<span class="pre-span" style="direction: ltr; text-align: left">Receive a message from the socket.</span>
</pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x53C2;&#x6570;&#xFF1A;</strong></span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>sockfd  -</strong>&#x5957;&#x63A5;&#x5B57;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>buf  -</strong>&#x7528;&#x4E8E;&#x63A5;&#x6536;&#x6570;&#x636E;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7F13;&#x51B2;&#x533A;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>len  -</strong> <em>buf</em>&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x5927;&#x5C0F;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>flags  -</strong>&#x7528;&#x4E8E;&#x4FEE;&#x6539;&#x5957;&#x63A5;&#x5B57;&#x884C;&#x4E3A;&#x7684;&#x6807;&#x5FD7;&#x7684;&#x6309;&#x4F4D;OR</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>src_addr  -</strong>&#x8FD4;&#x56DE;&#x5305;&#x542B;&#x6E90;&#x5730;&#x5740;&#x7684;&#x7ED3;&#x6784;</span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>addrlen  -</strong>&#x8FD4;&#x56DE;<em>src_addr</em>&#x7ED3;&#x6784;&#x5927;&#x5C0F;&#x7684;&#x53D8;&#x91CF;</span> </p><pre> <span class="pre-span" style="direction: ltr; text-align: left">int close(int fd)</span>
<span class="pre-span" style="direction: ltr; text-align: left">Close a file descriptor</span>
</pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x53C2;&#x6570;&#xFF1A;</strong></span> <br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>fd  -</strong>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5728;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x663E;&#x793A;&#x4E86;&#x5728;&#x670D;&#x52A1;&#x5668;&#x548C;&#x5BA2;&#x6237;&#x7AEF;&#x4E4B;&#x95F4;&#x4EA4;&#x6362;&#x4E00;&#x6761;&#x95EE;&#x5019;&#x6D88;&#x606F;&#x4EE5;&#x6F14;&#x793A;&#x6A21;&#x578B;&#x3002;</span> </p><div class="responsive-tabs"><h2 class="tabtitle sigil_not_in_toc"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> UDPServer.c</span> </h2><div class="tabcontent">

<pre class="brush: c; title: ; notranslate" title="">// Server side implementation of UDP client-server model
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;netinet/in.h&gt;

#define PORT     8080
#define MAXLINE 1024

// Driver code
int main() {
    int sockfd;
    char buffer[MAXLINE];
    char *hello = &quot;Hello from server&quot;;
    struct sockaddr_in servaddr, cliaddr;
    
    // Creating socket file descriptor
    if ( (sockfd = socket(AF_INET, SOCK_DGRAM, 0)) &lt; 0 ) {
        perror(&quot;socket creation failed&quot;);
        exit(EXIT_FAILURE);
    }
    
    memset(&amp;servaddr, 0, sizeof(servaddr));
    memset(&amp;cliaddr, 0, sizeof(cliaddr));
    
    // Filling server information
    servaddr.sin_family    = AF_INET; // IPv4
    servaddr.sin_addr.s_addr = INADDR_ANY;
    servaddr.sin_port = htons(PORT);
    
    // Bind the socket with the server address
    if ( bind(sockfd, (const struct sockaddr *)&amp;servaddr, 
            sizeof(servaddr)) &lt; 0 )
    {
        perror(&quot;bind failed&quot;);
        exit(EXIT_FAILURE);
    }
    
    int len, n;
    n = recvfrom(sockfd, (char *)buffer, MAXLINE, 
                MSG_WAITALL, ( struct sockaddr *) &amp;cliaddr,
                &amp;len);
    buffer[n] = &apos;\0&apos;;
    printf(&quot;Client : %s\n&quot;, buffer);
    sendto(sockfd, (const char *)hello, strlen(hello), 
        MSG_CONFIRM, (const struct sockaddr *) &amp;cliaddr,
            len);
    printf(&quot;Hello message sent.\n&quot;); 
    
    return 0;
}
</pre></div><h2 class="tabtitle sigil_not_in_toc"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> UDPClient.c</span> </h2><div class="tabcontent"><pre class="brush: c; title: ; notranslate" title="">// Client side implementation of UDP client-server model
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;netinet/in.h&gt;

#define PORT     8080
#define MAXLINE 1024

// Driver code
int main() {
    int sockfd;
    char buffer[MAXLINE];
    char *hello = &quot;Hello from client&quot;;
    struct sockaddr_in     servaddr;

    // Creating socket file descriptor
    if ( (sockfd = socket(AF_INET, SOCK_DGRAM, 0)) &lt; 0 ) {
        perror(&quot;socket creation failed&quot;);
        exit(EXIT_FAILURE);
    }

    memset(&amp;servaddr, 0, sizeof(servaddr));
    
    // Filling server information
    servaddr.sin_family = AF_INET;
    servaddr.sin_port = htons(PORT);
    servaddr.sin_addr.s_addr = INADDR_ANY;
    
    int n, len;
    
    sendto(sockfd, (const char *)hello, strlen(hello),
        MSG_CONFIRM, (const struct sockaddr *) &amp;servaddr, 
            sizeof(servaddr));
    printf(&quot;Hello message sent.\n&quot;);
        
    n = recvfrom(sockfd, (char *)buffer, MAXLINE, 
                MSG_WAITALL, (struct sockaddr *) &amp;servaddr,
                &amp;len);
    buffer[n] = &apos;\0&apos;;
    printf(&quot;Server : %s\n&quot;, buffer);

    close(sockfd);
    return 0;
}
</pre></div></div><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x8F93;&#x51FA;&#xFF1A;</strong></span> </p><pre> <span class="pre-span" style="direction: ltr; text-align: left">$ ./server</span>
<span class="pre-span" style="direction: ltr; text-align: left">Client : Hello from client</span>
<span class="pre-span" style="direction: ltr; text-align: left">Hello message sent.</span>
</pre><pre> <span class="pre-span" style="direction: ltr; text-align: left">$ ./client</span>
<span class="pre-span" style="direction: ltr; text-align: left">Hello message sent.</span>
<span class="pre-span" style="direction: ltr; text-align: left">Server : Hello from server</span>
</pre><br><!-- post_bottom_responsive --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9465609616171866" data-ad-slot="8385097921" data-ad-format="auto"></ins><br><br><hr><hr><!-- .entry-meta --></div></body></html>