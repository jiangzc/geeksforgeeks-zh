<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-x-mtfrom-en"><head><meta http-equiv="X-Translated-By" content="Google"><link href="https://apachecn.github.io/geeksforgeeks-zh/docs/en/net/146.html" hreflang="en" rel="alternate machine-translated-from"><title></title><link href="../../../styles/ebook.css" type="text/css" rel="stylesheet"></head><body><header class="entry-header"><h1 class="entry-title"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5728;Socket&#x4E2D;&#x660E;&#x786E;&#x5730;&#x5C06;&#x7AEF;&#x53E3;&#x53F7;&#x5206;&#x914D;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;</span> </h1></header><!-- .entry-header --><div class="entry-content"><p><!-- Problem Statement --><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5148;&#x51B3;&#x6761;&#x4EF6;&#xFF1A; <a href="https://www.geeksforgeeks.org/socket-programming-cc/">C / C ++&#x4E2D;&#x7684;&#x5957;&#x63A5;&#x5B57;&#x7F16;&#x7A0B;</a> &#x3002;</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5728;&#x5957;&#x63A5;&#x5B57;&#x7F16;&#x7A0B;&#x4E2D;&#xFF0C;&#x5F53;&#x670D;&#x52A1;&#x5668;&#x548C;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x65F6;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x4F1A;&#x901A;&#x8FC7;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x4EFB;&#x610F;&#x968F;&#x673A;&#x7AEF;&#x53E3;&#x53F7;&#x6765;&#x8FD0;&#x884C;&#xFF0C;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x5173;&#x5FC3;&#x5B83;&#xFF0C;&#x4F46;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x80FD;&#x53EA;&#x6709;&#x9632;&#x706B;&#x5899;&#x5141;&#x8BB8;&#x67D0;&#x4E9B;&#x7AEF;&#x53E3;&#x53F7;&#x4E0A;&#x7684;&#x4F20;&#x51FA;&#x8FDE;&#x63A5;&#x3002;</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x56E0;&#x6B64;&#xFF0C;&#x5F88;&#x53EF;&#x80FD;&#x7531;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x53EF;&#x80FD;&#x5DF2;&#x88AB;&#x5BA2;&#x6237;&#x7AEF;&#x9632;&#x706B;&#x5899;&#x963B;&#x6B62;&#x3002;</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;<strong>&#x660E;&#x786E;&#x6216;&#x5F3A;&#x5236;&#x5730;&#x5C06;&#x4EFB;&#x4F55;&#x7AEF;&#x53E3;&#x53F7;&#x5206;&#x914D;&#x7ED9;</strong>&#x5B83;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;<strong>&#x7684;&#x5BA2;&#x6237;&#x7AEF;</strong> &#x3002;</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x67D0;&#x4E9B;&#x534F;&#x8BAE;&#xFF08;&#x5982;<b><a href="https://en.wikipedia.org/wiki/Network_File_System">NFS</a></b>&#x534F;&#x8BAE;&#xFF09;&#x8981;&#x6C42;&#x5BA2;&#x6237;&#x7AEF;&#x7A0B;&#x5E8F;&#x4EC5;&#x5728;&#x67D0;&#x4E2A;&#x7AEF;&#x53E3;&#x53F7;&#x4E0A;&#x8FD0;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x53EA;&#x9700;&#x8981;&#x5728;111&#x6216;2049&#x4E0A;&#x7684;<a href="https://serverfault.com/questions/377170/which-ports-do-i-need-to-open-in-the-firewall-to-use-nfs">&#x7AEF;&#x53E3;&#x53F7;</a>&#x4E0A;&#x8FD0;&#x884C;&#x65F6;&#x5F3A;&#x5236;&#x5206;&#x914D;&#x8BE5;&#x7AEF;&#x53E3;&#x53F7;&#x3002;&#x8FD9;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;bind&#x5B8C;&#x6210;&#xFF08; &#xFF09;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x5957;&#x63A5;&#x5B57;&#x4E2D;&#x6307;&#x5B9A;&#x7279;&#x5B9A;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x3002;</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x4E0B;&#x9762;&#x662F;&#x5B9E;&#x65BD;&#x670D;&#x52A1;&#x5668;&#x548C;&#x5BA2;&#x6237;&#x7AEF;&#x7A0B;&#x5E8F;&#xFF0C;&#x5176;&#x4E2D;&#x5C06;&#x5F3A;&#x5236;&#x4E3A;&#x5BA2;&#x6237;&#x7AEF;&#x5206;&#x914D;&#x7AEF;&#x53E3;&#x53F7;&#x3002;</span> </p><p><!-- To show strongly recommend and practice link    --></p><div id="practiceLinkDiv"><h2 class="sigil_not_in_toc"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <a href="https://ide.geeksforgeeks.org/">&#x5EFA;&#x8BAE;&#xFF1A;&#x5728;&#x7EE7;&#x7EED;&#x4F7F;&#x7528;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x4E4B;&#x524D;&#xFF0C;&#x8BF7;&#x5148;&#x5728;<b><i><u>{IDE}</u></i></b>&#x4E0A;&#x5C1D;&#x8BD5;&#x60A8;&#x7684;&#x65B9;&#x6CD5;&#x3002;</a></span> </h2></div><br><!-- post_top_responsive --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9465609616171866" data-ad-slot="4501693235" data-ad-format="auto"></ins><br><p align="center"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x7A0B;&#x5E8F;</strong></span> </p>
<pre class="brush: c; title: ; notranslate" title="">// C program to demonstrate 
// socket programming in finding ip address 
// and port number of connected client
// on Server Side
#include&lt;stdio.h&gt;
#include&lt;sys/types.h&gt;
#include&lt;sys/socket.h&gt;
#include&lt;sys/un.h&gt;
#include&lt;string.h&gt;
#include&lt;netdb.h&gt;
#include&lt;netinet/in.h&gt;
#include&lt;arpa/inet.h&gt;
#include&lt;string.h&gt;

int main()
{
	// Two buffers for message communication
	char buffer1[256], buffer2[256];
	int server = socket(AF_INET, SOCK_STREAM, 0);
	if (server &lt; 0)
		printf(&quot;Error in server creating\n&quot;);
	else
		printf(&quot;Server Created\n&quot;);
		
	struct sockaddr_in my_addr, peer_addr;
	my_addr.sin_family = AF_INET;
	my_addr.sin_addr.s_addr = INADDR_ANY;
	
	// This ip address will change according to the machine
	my_addr.sin_addr.s_addr = inet_addr(&quot;10.32.40.213&quot;);
	
	my_addr.sin_port = htons(12000);

	if (bind(server, (struct sockaddr*) &amp;my_addr, sizeof(my_addr)) == 0)
		printf(&quot;Binded Correctly\n&quot;);
	else
		printf(&quot;Unable to bind\n&quot;);
		
	if (listen(server, 3) == 0)
		printf(&quot;Listening ...\n&quot;);
	else
		printf(&quot;Unable to listen\n&quot;);
	
	socklen_t addr_size;
	addr_size = sizeof(struct sockaddr_in);
	
	// Ip character array will store the ip address of client
	char *ip;
	
	// while loop is iterated infinitely to 
	// accept infinite connection one by one
	while (1)
	{
		int acc = accept(server, (struct sockaddr*) &amp;peer_addr, &amp;addr_size);
		printf(&quot;Connection Established\n&quot;);
		char ip[INET_ADDRSTRLEN];
		inet_ntop(AF_INET, &amp;(peer_addr.sin_addr), ip, INET_ADDRSTRLEN);
	
		// &quot;ntohs(peer_addr.sin_port)&quot; function is 
		// for finding port number of client
		printf(&quot;connection established with IP : %s and PORT : %d\n&quot;, 
		                                    ip, ntohs(peer_addr.sin_port));

		recv(acc, buffer2, 256, 0);
		printf(&quot;Client : %s\n&quot;, buffer2);
		strcpy(buffer1, &quot;Hello&quot;);
		send(acc, buffer1, 256, 0);
	} 
	return 0;
}
</pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x8F93;&#x51FA;&#xFF1A;</span> </p><pre> <span class="pre-span" style="direction: ltr; text-align: left">Server Created</span>
<span class="pre-span" style="direction: ltr; text-align: left">Binded Correctly</span>
<span class="pre-span" style="direction: ltr; text-align: left">Listening ...</span>
<span class="pre-span" style="direction: ltr; text-align: left">Connection Established</span>
<span class="pre-span" style="direction: ltr; text-align: left">connection established with IP : 10.32.40.213 and PORT : 12010</span>
<span class="pre-span" style="direction: ltr; text-align: left">Client : Hello</span>
<!-- Your Output -->
</pre><p align="center"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <strong>&#x5BA2;&#x6237;&#x7AEF;&#x8BA1;&#x5212;</strong></span> </p><pre class="brush: cpp; title: ; notranslate" title="">// C program to demonstrate socket programming
// as well as explicitly assigning a port number
// on Client Side
#include&lt;stdio.h&gt;
#include&lt;sys/types.h&gt;
#include&lt;sys/socket.h&gt;
#include&lt;sys/un.h&gt;
#include&lt;string.h&gt;
#include&lt;netdb.h&gt;
#include&lt;netinet/in.h&gt;
#include&lt;arpa/inet.h&gt;
#include&lt;stdlib.h&gt;

int main()
{
	// Two buffer are for message communication
	char buffer1[256], buffer2[256];
	struct sockaddr_in my_addr, my_addr1;
	int client = socket(AF_INET, SOCK_STREAM, 0);
	if (client &lt; 0)
	printf(&quot;Error in client creating\n&quot;);
	else
		printf(&quot;Client Created\n&quot;);
		
	my_addr.sin_family = AF_INET;
	my_addr.sin_addr.s_addr = INADDR_ANY;
	my_addr.sin_port = htons(12000);
	
	// This ip address will change according to the machine
	my_addr.sin_addr.s_addr = inet_addr(&quot;10.32.40.213&quot;);

	// Explicitly assigning port number 12010 by 
	// binding client with that port 
	my_addr1.sin_family = AF_INET;
	my_addr1.sin_addr.s_addr = INADDR_ANY;
	my_addr1.sin_port = htons(12010);
	
	// This ip address will change according to the machine
	my_addr1.sin_addr.s_addr = inet_addr(&quot;10.32.40.213&quot;);
	if (bind(client, (struct sockaddr*) &amp;my_addr1, sizeof(struct sockaddr_in)) == 0)
		printf(&quot;Binded Correctly\n&quot;);
	else
		printf(&quot;Unable to bind\n&quot;);
	
	socklen_t addr_size = sizeof my_addr;
	int con = connect(client, (struct sockaddr*) &amp;my_addr, sizeof my_addr);
	if (con == 0)
		printf(&quot;Client Connected\n&quot;);
	else
		printf(&quot;Error in Connection\n&quot;);

	strcpy(buffer2, &quot;Hello&quot;);
	send(client, buffer2, 256, 0); 
	recv(client, buffer1, 256, 0);
	printf(&quot;Server : %s\n&quot;, buffer1);
	return 0;
}
</pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()">&#x8F93;&#x51FA;&#xFF1A;</span> </p><pre> <span class="pre-span" style="direction: ltr; text-align: left">Client Created</span>
<span class="pre-span" style="direction: ltr; text-align: left">Binded Correctly</span>
<span class="pre-span" style="direction: ltr; text-align: left">Client Connected</span>
<span class="pre-span" style="direction: ltr; text-align: left">Server : Hello</span>
<!-- Your Output -->
</pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"> <b>&#x53C2;&#x8003;</b> &#xFF1A; <a>https</a> &#xFF1A; <a>//stackoverflow.com/questions/4118241/what-c&#x200B;&#x200B;lient-side-situations-need-bind</a></span> </p><p><!-- To show list of companies where this problem is asked. Please remove if doesn't fit.    --></p><br><!-- post_bottom_responsive --><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9465609616171866" data-ad-slot="8385097921" data-ad-format="auto"></ins><br><br><!-- .entry-meta --></div></body></html>